<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
        content="The Shifting Chasm - A roguelike dungeon crawler where the map changes beneath your feet. Fight monsters, loot gear, and escape the lava!">
    <title>The Shifting Chasm</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸŒ‹</text></svg>">
</head>
<body>
    <h1 style="display:none;">The Shifting Chasm</h1>
    <canvas id="gameCanvas"></canvas>
    <div id="debug"></div>
    
    <!-- ========================================== -->
    <!-- SYSTEMMANAGER ARCHITECTURE                -->
    <!-- ========================================== -->
    
    <!-- ==================== -->
    <!-- CORE: Load first     -->
    <!-- ==================== -->
    <script src="js/core/constants.js"></script>
    <script src="js/core/game-state.js"></script>
    <script src="js/core/save-manager.js"></script>
    <script src="js/core/session-manager.js"></script>
    <script src="js/core/system-manager.js"></script>
    
    <!-- ==================== -->
    <!-- DATA: Static definitions (no registration) -->
    <!-- ==================== -->
    <script src="js/data/elements.js"></script>
    <script src="js/data/element-matrix.js"></script>
    <script src="js/data/monsters-data.js"></script>
    <script src="js/data/monster-tiers.js"></script>
    <script src="js/data/ability-repository.js"></script>
    <script src="js/data/quest-items.js"></script>
    <script src="js/data/items.js"></script>
    <script src="js/data/weapon-types.js"></script>
    <script src="js/data/weapons-melee.js"></script>
    <script src="js/data/weapons-ranged.js"></script>
    <script src="js/data/weapons-magic.js"></script>
    <script src="js/data/armor-types.js"></script>
    <script src="js/data/armor-defense.js"></script>
    <script src="js/data/armor-mobility.js"></script>
    <script src="js/data/weapon-armor-matrix.js"></script>
    <script src="js/data/tileset-reference.js"></script>
    <script src="js/data/tileset-floors-1-2.js"></script>
    <script src="js/data/room-themes.js"></script>
    <script src="js/data/npcs.js"></script>
    <script src="js/data/elder-dialogue.js"></script>
    <script src="js/data/lore-fragments.js"></script>
    <script src="js/data/village-tile-states.js"></script>
    <script src="js/data/materials.js"></script>
    <script src="js/data/quests.js"></script>
    <script src="js/data/crafting-data.js"></script>
    <script src="js/data/core-data.js"></script>

    <!-- ==================== -->
    <!-- UTILS: Helper functions (no registration) -->
    <!-- ==================== -->
    <script src="js/utils/message-log.js"></script>
    <script src="js/utils/Collision.js"></script>
    <script src="js/utils/movement-utils.js"></script>
    <script src="js/utils/pathfinding.js"></script>
    <script src="js/utils/damage-calculator.js"></script>
    <script src="js/utils/stat-system.js"></script>
    
    <!-- ==================== -->
    <!-- ENTITIES: Factories (no registration) -->
    <!-- ==================== -->
    <script src="js/entities/equipment-loader.js"></script>
    <script src="js/entities/player.js"></script>
    <script src="js/entities/enemy.js"></script>
    <script src="js/entities/npc.js"></script>
    <script src="js/entities/boss.js"></script>
    <script src="js/entities/extraction-point.js"></script>
    <script src="js/entities/core-boss.js"></script>
    <script src="js/entities/malphas-boss.js"></script>

    <!-- ==================== -->
    <!-- GENERATION: Map building (no registration) -->
    <!-- ==================== -->
    <script src="js/generation/chamber-generator.js"></script>

    <!-- Blob-based dungeon system -->
    <script src="js/generation/dungeon-generator.js"></script>
    <script src="js/generation/dungeon-integration.js"></script>

    <!-- NEW: Extraction system generation -->
    <script src="js/generation/extraction-spawner.js"></script>

    <!-- NEW: Village generation -->
    <script src="js/generation/village-generator.js"></script>

    <!-- NEW: Core (final boss) generation -->
    <script src="js/generation/core-generator.js"></script>

    <!-- ==================== -->
    <!-- TESTING: Analysis tools (no registration) -->
    <!-- ==================== -->
    <script src="js/testing/map-gen-analyzer.js"></script>

    <!-- ==================== -->
    <!-- RENDERING: Display (no registration) -->
    <!-- ==================== -->
    <script src="js/ui/ui-design-system.js"></script>
    <script src="js/ui/tile-renderer.js"></script>
    <script src="js/ui/monster-animations.js"></script>
    <script src="js/ui/sprite-loader.js"></script>
    <script src="js/ui/enemy-renderer.js"></script>
    <script src="js/ui/enemy-movement-updater.js"></script>
    <script src="js/ui/renderer.js"></script>
    <script src="js/ui/ui-renderer.js"></script>
    <script src="js/ui/skills-ui.js"></script>
    <script src="js/ui/action-bar-ui.js"></script>

    <!-- NEW: Modern UI components (icon sidebar, unit frames, mini-map) -->
    <script src="js/ui/icon-sidebar.js"></script>
    <script src="js/ui/unit-frames.js"></script>
    <script src="js/ui/mini-map.js"></script>
    <script src="js/ui/character-overlay.js"></script>
    <script src="js/ui/map-overlay.js"></script>
    <script src="js/ui/shift-overlay.js"></script>
    <script src="js/ui/chest-ui.js"></script>

    <!-- NEW: Village UI components -->
    <script src="js/ui/village-renderer.js"></script>
    <script src="js/ui/dialogue-ui.js"></script>
    <script src="js/ui/bank-ui.js"></script>
    <script src="js/ui/loadout-ui.js"></script>
    <script src="js/ui/shop-ui.js"></script>
    <script src="js/ui/quest-ui.js"></script>
    <script src="js/ui/crafting-ui.js"></script>
    <script src="js/ui/extraction-ui.js"></script>
    <script src="js/ui/journal-ui.js"></script>

    <script src="js/ui/right-click-init.js"></script>
    
    <!-- ==================== -->
    <!-- SYSTEMS: Register with SystemManager -->
    <!-- Order doesn't matter - priority handles execution order -->
    <!-- ==================== -->

    <!-- NEW: World State System (narrative progression) -->
    <script src="js/systems/world-state-system.js"></script>

    <!-- NEW: Shift shared systems (load early, low priorities) -->
    <script src="js/systems/light-source-system.js"></script>       <!-- Priority 4 (before vision) -->
    <script src="js/systems/shift-bonus-system.js"></script>        <!-- Priority 5 (bonuses) -->

    <script src="js/systems/vision-system.js"></script>             <!-- Priority 5 (Fog of War) -->
    <script src="js/systems/input-handler.js"></script>             <!-- Priority 10 -->
    <script src="js/systems/pokemon-movement.js"></script>          <!-- Priority 20 -->
    <script src="js/systems/player-animation.js"></script>          <!-- Priority 25 -->
    <script src="js/systems/noise-system.js"></script>              <!-- Priority 30 -->
    <script src="js/systems/hazard-system.js"></script>             <!-- Priority 35 -->

    <!-- NEW: Dynamic shift systems (mid-priority) -->
    <script src="js/systems/dynamic-tile-system.js"></script>       <!-- Priority 36 -->
    <script src="js/systems/environmental-meter-system.js"></script><!-- Priority 37 -->
    <script src="js/systems/spawn-point-system.js"></script>        <!-- Priority 38 -->
    <script src="js/systems/enemy-ability-system.js"></script>      <!-- Priority 38 (enemy abilities) -->

    <script src="js/systems/enemy-ai.js"></script>                  <!-- Priority 40 -->
    <script src="js/systems/monster-social-system.js"></script>     <!-- Priority 42 -->
    <script src="js/systems/monster-animation-system.js"></script>  <!-- Priority 43 -->
    <script src="js/systems/combat-system.js"></script>             <!-- Priority 50 -->
    <script src="js/systems/projectile-system.js"></script>         <!-- Projectile travel time -->
    <script src="js/effects/melee-slash-effect.js"></script>        <!-- Code-based melee attack effects -->
    <script src="js/effects/monster-attack-effects.js"></script>    <!-- Monster magic/ranged attack effects -->
    <script src="js/effects/village-atmosphere.js"></script>        <!-- Village world state atmosphere -->
    <script src="js/effects/particle-system.js"></script>          <!-- Particle canvas layer for fire, magic, etc. -->
    <script src="js/systems/combat-effect-system.js"></script>      <!-- Priority 51: Combat visual effects -->
    <script src="js/systems/active-combat.js"></script>             <!-- Active combat hotkeys -->
    <script src="js/systems/combat-enhancements.js"></script>       <!-- Dash, knockback, screen shake, stagger -->
    <script src="js/systems/mouse-attack-system.js"></script>      <!-- Mouse-driven attacks -->
    <script src="js/systems/skills-combat-integration.js"></script> <!-- Priority 55 -->
    <script src="js/systems/status-effect-system.js"></script>      <!-- Priority 56 -->
    <script src="js/systems/skill-system.js"></script>              <!-- Priority 60 -->
    <script src="js/systems/inventory-system.js"></script>          <!-- Priority 65 -->
    <script src="js/systems/quest-item-system.js"></script>         <!-- Priority 66 (quest items) -->
    <script src="js/systems/loot-system.js"></script>               <!-- Priority 70 -->

    <!-- NEW: Survival Extraction systems -->
    <script src="js/systems/banking-system.js"></script>           <!-- Banking/storage -->
    <script src="js/systems/loadout-system.js"></script>           <!-- Pre-run loadout -->
    <script src="js/systems/extraction-system.js"></script>        <!-- Priority 75: Extraction points -->
    <script src="js/systems/village-system.js"></script>           <!-- Village hub management -->
    <script src="js/systems/quest-system.js"></script>             <!-- Priority 85: Quest tracking -->
    <script src="js/systems/shortcut-system.js"></script>          <!-- Floor shortcuts -->
    <script src="js/systems/degradation-system.js"></script>       <!-- Village/floor degradation -->
    <script src="js/systems/rescue-system.js"></script>            <!-- Death drop/rescue runs -->
    <script src="js/systems/crafting-system.js"></script>          <!-- Priority 88: Crafting -->
    <script src="js/systems/core-system.js"></script>              <!-- Priority 95: The Core -->
    <script src="js/systems/survival-integration.js"></script>     <!-- Priority 1: Integration layer -->

    <script src="js/systems/shift-system.js"></script>              <!-- Priority 80 -->

    <!-- ==================== -->
    <!-- MAIN: Load last      -->
    <!-- ==================== -->
    <script src="js/core/game-init.js"></script>
    <script src="js/core/main.js"></script>

    <!-- ==================== -->
    <!-- DEBUG: Load after everything else -->
    <!-- ==================== -->
    <script src="debug-commands.js"></script>
</body>
</html>